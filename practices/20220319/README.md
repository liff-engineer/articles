# 内存文档序列化方案

- 支持基本数据类型、map/list等容器、复合数据类型等等(以及派生类体系)
- 数据升级

## 结构拆分

- 存档`Archive`,支持序列化为不同数据格式;
- 元信息`Meta`,支持结构体/类的数据成员信息表述,以降低序列化编码量和出错率;
- 升级机制

## 升级机制

文档由不同的`Object`构成,以`Object`为基本单位来考虑升级.

### 如何判断需要升级?

判断是否需要升级必然涉及到`Object`的版本号,手工定义不太好,可以考虑自动定义,譬如一旦为其书写升级器,则遍历升级器的编号,取`最大编号`作为要保存的版本号,即,只要经过这部分代码处理,就不需要升级;否则就需要走升级流程.

### 升级场景

#### `Object`级别变更

1. 新增成员变量:无需升级
2. 删除成员变量:无需升级
3. 更改数据类型:需要升级

#### 多个`Object`变更

1. 旧`Object`替换为新`Object`,全部手写
2. 旧`Object`拆分为多个新`Object`,全部手写

